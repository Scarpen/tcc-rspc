<p id="notice"><%= notice %></p>

<h1>Lista de Pessoas</h1>

<table>
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>E-mail</th>
      <th colspan="3">Ações</th>
    </tr>
  </thead>

  <tbody>
    <% @users.each do |user| %>
      <% if user.id != current_user.id %>
        <tr>
          <td><%= image_tag(user.avatar) %></td>
          <td><%= user.name %></td>
          <td><%= user.email %></td>
          <td><%= link_to 'Visualizar Perfil', user_path(id: user.id) %>

            <% if Friend.where(user_id: current_user.id, friend_id: user.id).first %>
              <% if Friend.where(user_id: current_user.id, friend_id: user.id).first.status == 'request' %>
                Solicitação realizada
                <%= link_to 'Cancelar' %>
              <% end %>
              <% if Friend.where(user_id: current_user.id, friend_id: user.id).first.status == 'pending' %>
              <%= link_to 'Aceitar' %>
              <%= link_to 'Recusar' %>
              <% end %>
            <%else%>
              <%= link_to 'Solicitar Amizade', friend_request_friends_path(user: user) %>
            <% end %>           
        </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
